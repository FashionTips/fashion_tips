DROP TABLE IF EXISTS image_post;
DROP TABLE IF EXISTS posts;
DROP INDEX IF EXISTS category_type;
DROP TABLE IF EXISTS category;
DROP INDEX IF EXISTS email;
DROP INDEX IF EXISTS login;
DROP TABLE IF EXISTS roles;
DROP TABLE IF EXISTS users ;

CREATE TABLE users (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
  login VARCHAR(255),
  email VARCHAR(255),
  password VARCHAR(255)
);

CREATE UNIQUE INDEX login ON users (login);

CREATE UNIQUE INDEX email ON users (email);

CREATE TABLE posts (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
  user_id BIGINT NOT NULL,
  image_Path VARCHAR(256),
  title VARCHAR(256) NOT NULL ,
  user_post VARCHAR(256),
  created TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  category VARCHAR(64),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE roles (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) PRIMARY KEY,
  role VARCHAR(128),
  description VARCHAR(255),
  user_id BIGINT NOT NULL,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE
);
